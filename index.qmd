---
title: "Meteoric Fall: a comet-ment to data"
subtitle: "INFO 526 - Project Final"
author: 
  - name: "**Viz Wizards** - Nick Ferrante, Jeremiah Gaiser, Tanya Evita George,<br> Mrunal Jadhav, Jasdeep Singh Jhajj, Gillian McGinnis, Agastya Deshraju"
    affiliations:
      - name: "School of Information, University of Arizona"
description: "Developing a Shiny app to explore and analyze meteorite landings data, unraveling patterns and insights into meteor impact distribution and historical events"
format:
   html:
    code-tools: true
    code-overflow: wrap
    embed-resources: true
editor: visual
execute:
  warning: false
  echo: false
---

```{r load_pkgs}
#| label: load_pkgs
#| echo: false
#| message: false
#| warning: false
#| code-summary: "Load Packages"

if (!require("pacman")) 
  install.packages("pacman")

pacman::p_load(tidyverse,
               readr,
               leaflet,
               here,
               gganimate,
               magick,
               sysfonts,
               showtext,
               DT) 
```

## Abstract

The goal of "Meteoric Fall: A Comet-ment to Data" was to explore the complex relationships between meteorite impacts, historical events, and celestial phenomena through data visualization techniques. While the project utilized the capabilities of the Shiny app, the primary focus was on investigating geo-spatiotemporal relationships using various forms of visualization. These included animated timelines for spatiotemporal analysis, static maps for mass distribution, leaflet maps for user interactivity, and custom maps for data exploration. By addressing questions about meteorite distribution, historical events, and celestial correlations, our analysis aimed to deepen understanding in fields such as geology, astronomy, and data analytics. Through these visualizations, we aimed to offer insights that would spark further exploration and scientific discourse.

## Introduction

The suggested idea introduces an interactive platform powered by Shiny app in an effort to close the knowledge gap between meteorite landing data and perceptive analysis. Humanity has always been captivated by meteorite strikes, but little is known about their distribution and potential consequences. Users will have access to a dynamic environment through this effort, where visually appealing representations will allow them to navigate through meteorite landing data. This study aims to provide important insights by addressing important questions about the historical settings and geographical distribution of meteorite impacts. Moreover, the technology hopes to provide predictive skills for future meteorite impact sites by extrapolation from historical data. The expected results have the potential to inform decision-making processes in relevant disciplines and to enhance scientific discourse.

```{r load_dataset}
#| label: load_dataset
#| message: false
#| warning: false
#| code-summary: "Loading and cleaning the Dataset"
#| echo: false
#| output: false


# Read the CSV file
meteorite_data <- read_csv(here("data/Meteorite_Landings.csv"))


meteorite_data <- meteorite_data |> 
  na.omit(year)

meteorite_data$year <- as.numeric(meteorite_data$year)

meteorite_data_filtered <- meteorite_data |>
                            filter(year > 860 & year < 2100)

meteorite_data_filtered$reclong[meteorite_data_filtered$reclat == 0 &
                                meteorite_data_filtered$reclong == 0] <- NA
meteorite_data_filtered$reclat[meteorite_data_filtered$reclat == 0 & 
                               meteorite_data_filtered$reclong == 0] <- NA


meteorite_data_filtered <- meteorite_data_filtered |>
                            filter(!is.na(reclong) & !is.na(reclat))

meteorite_data_filtered <- meteorite_data_filtered |>
  rename(mass = `mass (g)`)
```

## Question 1: What does the distribution of meteor impacts look like across the earth? - Which continents have accumulated the most total mass of meteors?

## Static Plot to visualize meteorites that were recorded before falling.

```{r filter_meteorites, fig.alt= "World map showing the different recorded locations where meteorites fell to Earth"}
#| label: filter_meteorites
#| message: false
#| warning: false
#| code-summary: "Filtering meteorites"


# Adding a filter to classify the size of the meteorites
filtered_data <- subset(meteorite_data_filtered, `mass (g)` > 1000 & fall == "Fell")
filtered_data$meteor_size <- cut(filtered_data$`mass (g)`,
                                 breaks = c(0, 10000, 100000, Inf),
                                 labels = c("light", "average mass", "heavy"))

# Plot the world map
world_map <- ggplot() +
  geom_polygon(data = map_data("world"),
               aes(x = long,
                   y = lat,
                   group = group),
               fill = "lightblue",
               color = "black",
               size = 0.25) +
  geom_point(data = filtered_data,
             aes(x = reclong,
                 y = reclat,
                 color = meteor_size),
             size = 1.5) +
  labs(title = "Meteorite Landings (Fallen)") +
  scale_color_manual(values = c("light" = "yellow",
                                "average mass" = "orange",
                                "heavy" = "red")) +
  theme_minimal() +
  labs(x = "Longitutde",
       y = "Latitutde",
       color = "Meteor Size") +
  theme(
    legend.position = "bottom"
  )

# Show the plot
print(world_map)

```

**Geographical Distribution:** The map utilizes latitude and longitude coordinates to display the locations of meteorite landings. Notably, there's a higher concentration of landings in the northern hemisphere compared to the southern hemisphere, as indicated by the density of dots.\
**Meteorite Size Representation:** The colored dots on the map represent meteorites, with each color indicating a different size category. Light yellow dots denote light meteorites, orange dots signify meteorites of average mass, and red dots represent heavy meteorites. This color scheme allows for a visual understanding of the distribution of meteorite sizes.\
**Meteorite Density:** The density of the colored dots across various geographical regions reflects the frequency of meteorite landings in those areas. Regions with a greater density of dots have experienced more meteorite landings, suggesting higher meteorite activity.\
In summary, this map provides an intriguing visualization of meteorite landings worldwide, offering insights into the distribution of meteorite sizes and their density across different geographical areas.

## Static Plot to visualize meteorites recorded after falling.

```{r meteorite_found, fig.alt= "World map showing the different recorded locations of meteorites before falling"}
#| label: meteorite_found
#| message: false
#| warning: false
#| code-summary: "Plotting Found meteorites"

# Filter the data for meteorites that have not fallen and classify mass
filtered_data_not_fallen <- subset(meteorite_data_filtered, `mass (g)` > 1000 & fall == "Found")
filtered_data_not_fallen$meteor_size <- cut(filtered_data_not_fallen$`mass (g)`,
                                            breaks = c(0, 10000, 100000, Inf), 
                                            labels = c("light", "average mass", "heavy"))

# Plot the world map for meteorites that have not fallen
world_map_not_fallen <- ggplot() +
  geom_polygon(data = map_data("world"),
               aes(x = long,
                   y = lat,
                   group = group),
               fill = "lightblue",
               color = "black",
               size = 0.25) +
  geom_point(data = filtered_data_not_fallen,
             aes(x = reclong,
                 y = reclat,
                 color = meteor_size),
             size = 1.5) +
  labs(title = "Meteorite Landings (Not Fallen)") +
  scale_color_manual(values = c("light" = "yellow",
                                "average mass" = "orange",
                                "heavy" = "red")) +
  theme_minimal() +
  labs(x = "Longitutde",
       y = "Latitutde",
       color = "Meteor Size") +
  theme(
    legend.position = "bottom"
  )

# Show the plot
print(world_map_not_fallen)


```

The graph provides latitude on the vertical axis ranging from -50 to 50 and longitude on the horizontal axis ranging from -100 to 200.The sizes of the meteorites are categorized into three groups: light, average mass, and heavy, represented by yellow, orange, and red dots respectively.

**Northern Hemisphere**: Thereâ€™s a significant clustering of meteorites across the northern hemisphere. Europe and parts of Asia show a dense collection of average mass to heavy meteorites. North America also displays clusters but with more light to average mass meteorites.\
**Southern Hemisphere**: There are fewer landings depicted in the southern hemisphere with some scattered light ones across Australia and South America.\
In summary, this map provides an intriguing visualization of meteorite not fallen worldwide, offering insights into the distribution of meteorite sizes and their density across different geographical areas.

### Leaflet

```{r}
meteorite_data_filtered_fell <- meteorite_data_filtered |>
  filter(meteorite_data_filtered$fall == "Fell")


map_plot <- leaflet(data = meteorite_data_filtered_fell) |>
  addTiles() |>
  addMarkers(lat = ~reclat, 
             lng = ~reclong,
             clusterOptions = markerClusterOptions(disableClusteringAtZoom = 3),
             popup = ~paste("Name:", name,
                            "<br>Class:", recclass,
                            "<br>Mass:", mass, "g",
                            "<br>Year:", year,
                            "<br>Latitude:", reclat,
                            "<br>Longitude:", reclong),
             icon = makeIcon("images/meteorite.png", 
                             iconWidth = 12, 
                             iconHeight = 12)) |>
  setMaxBounds(lng1 = -180, lng2 = 180, lat1 = 90, lat2 = -90)
  

map_plot

```

The distribution of meteor impacts across the Earth is depicted through an interactive leaflet map. This visualization allows users to navigate and explore specific regions of the world where meteorites have landed. By leveraging latitude and longitude coordinates, obtained from the reclat and reclog variables, the map accurately plots the locations of meteorite impacts. Users can interact with the map to retrieve detailed information about each meteor, including the year it fell or was found, its mass, and potentially its classification characteristics. This interactive approach provides users with a dynamic and engaging means of exploring the distribution of meteor impacts, enabling them to gain deeper insights into the spatial patterns of meteorite landings across the globe.\
\
To determine which continents have accumulated the most total mass of meteorites, we analyse the data by continent and consider both the frequency of meteor observations and the mass of each meteor. By aggregating the mass of meteorites on each continent, we create a density map that visually illustrates the distribution of total mass across continents. This density map enables us to identify continents with the highest accumulation of meteorite mass. By examining the density of meteorite mass across continents, we can discern patterns and trends regarding the geographical distribution of meteorite impacts. This analysis provides valuable insights into the relative significance of different continents in terms of meteorite accumulation, facilitating a better understanding of the global distribution of meteorite impacts and their implications for scientific research and exploration.

### Shiny application

To allow accessible exploration of the meteorite landing data, a Shiny application was also developed to visualize the geospatial values. The application can be accessed [here](https://gmcginnis.shinyapps.io/MeteoriteMap/).

A sample is shown below; filters include the year range, mass of meteorite, and method of discovery. Furthermore, users can customize the map to better suit the data subset---point size, transparency, and even the map projection type may be selected.

[![A screenshot of the meteorite landings map application, including a sidebar of filtering options, outputted map plot, and outputted table of results.](images/shiny_landings_sample.png)](https://gmcginnis.shinyapps.io/MeteoriteMap/)

## Question 2: How do historical events relate to the observations and discoveries of meteors?

```{r}
#| label: Creation of time series plot and world map
#| eval: false

# # Load Google font
font_add_google(name = "Lato", family = "Lato")
showtext_auto()

# Create line plot
linePlot <- meteorite_data |>
  group_by(year) |>
  summarise(count = n()) |>
  filter(year > 1950 & year < 2100) |>
  ggplot(aes(x = year, y = count)) +
  geom_line(linewidth = 1,
            color = "#607D8B") +
  annotate("segment",
           x = 1975,
           xend = 1975,
           y = 0,
           yend = 3500,
           linetype = "dotted") +
  annotate("segment",
           x = 1999,
           xend = 1999,
           y = 0,
           yend = 3500,
           linetype = "dotted") +
  annotate("segment",
           x = 2001,
           xend = 2001,
           y = 0,
           yend = 3500,
           linetype = "dotted") +
  annotate("segment",
           x = 2002,
           xend = 2002,
           y = 0,
           yend = 3500,
           linetype = "dotted") +
  annotate("segment",
           x = 1955,
           xend = 1955,
           y = 0,
           yend = 3500,
           linetype = "dotted") +
  annotate("text",
           x = 1975,
           y = 3700,
           label = "End of the\nSpace race",
           family = "Lato") +
  annotate("text",
           x = 2000,
           y = 3650,
           label = "Last Leonid Showers",
           family = "Lato") +
  annotate("text",
           x = 1955,
           y = 3700,
           label = "Start of the\nSpace race",
           family = "Lato") +
  coord_cartesian(ylim = c(150,3820)) +
  labs(x = "Year",
       y = "Number of Observations") +
  theme_classic() +
  theme(plot.title.position = "plot",
        panel.grid.major.y = element_line()) +
  transition_reveal(year)

# Animate Line plot
linePlotGif <- animate(linePlot,
                       fps = 4,
                       nframes = 100,
                       width = 600,
                       height = 400)

# Create world map
worldMap <- meteorite_data |>
  group_by(year) |>
  filter(year > 1950 & year < 2100,
         !is.na(reclat),
         !is.na(reclong),
         reclong < 350) |>
  ggplot(aes(x = reclong, y = reclat)) +
  geom_polygon(data = as_tibble(map_data("world")),
               aes(x = long, y = lat, group = group),
               inherit.aes=F,
               fill = "white") +
  coord_quickmap() +
  geom_point() +
  labs(title = "Time Series of Meteor Observations by Year",
       subtitle = "Current Year: {closest_state}") +
  theme_void() +
  theme(panel.background = element_rect(fill = "skyblue"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  transition_states(year,
                    transition_length = 1,
                    state_length = 1) +
  shadow_wake(wake_length = 0.25) +
  enter_fade()

# Animate world map
worldMapGif <- animate(worldMap,
        fps = 4,
        nframes = 100,
        width = 600,
        height = 1100)



### Putting animations together

# Modify white space margins around plots
linePlotGifImg <- image_read(here("images", "linePlotGif.gif"))
worldMapGifImg <- image_read(here("images", "worldMapGif.gif"))

lpMGif <- image_border(image_trim(linePlotGifImg), "white", "20x20")
wmMGif <- image_border(image_trim(worldMapGifImg), "white", "20x20")

# Arrange plots on top of each other
finalPlot <- image_append(c(wmMGif[1], lpMGif[1]),
                       stack = TRUE)
for (i in 2:100){
  combined <- image_append(c(wmMGif[i], lpMGif[i]),
                           stack = TRUE)
  finalPlot <- c(finalPlot, combined)
}

```

```{r}
#| label: Display question 2 plot

historyPlot <- image_read(here("images", "historyOfEvents.gif"))

historyPlot

```

To explore the relationship between historical events and the observations and discoveries of meteors, we employ an animated line graph showcasing the frequency of meteor observations per year. This dynamic visualization allows us to discern any correlations between significant historical events and spikes or dips in meteor observations over time. By incorporating annotations representing major historical events, we can examine whether certain events coincide with increased or decreased activity in the study of meteors.

The animation illustrates the progression of meteor observations across different time periods, with historical events appearing on the timeline as they occur. This approach enables us to identify potential patterns or trends in meteor observation activity associated with specific historical events. For instance, we may observe a surge in meteor findings following significant milestones in space exploration, such as the space race era. By analysing the relationship between historical events and meteor observations, we aim to uncover insights into the societal and scientific factors influencing the study of meteors throughout history.

This analysis not only enhances our understanding of the interplay between historical events and meteor observations but also sheds light on the broader context in which meteor studies have evolved. By contextualizing meteor observations within historical narratives, we can glean valuable insights into the motivations and influences driving scientific inquiry in the field of meteoritics.

## Question 3: Are trends observed in frequency, type, or location of meteors, related to known celestial events?

To investigate the relationship between trends in meteor frequency, type, or location and known celestial events, we adopt a multifaceted approach that integrates meteor data analysis with insights from astronomical occurrences. Meteors, originating from neighboring celestial bodies within our solar system, are expected to exhibit patterns influenced by Earth's proximity to astronomical phenomena such as comets, planets, and the moon.

Our analysis aims to identify statistically significant patterns in meteor data that may correlate with specific celestial events. For example, we anticipate observing increased meteor activity during annual meteor showers, such as the Lyrids, which result from Earth passing through the debris path of comets. Additionally, close encounters with planets or other celestial bodies may also influence meteor activity.

To pinpoint such events, we analyse meteor data over time, identifying clusters of activity that deviate significantly from typical observations. We then cross-reference these periods of heightened activity with external data sources, such as NASA.gov, to ascertain if they coincide with known astronomical events.

These findings are integrated into our meteor impact visualizations to provide a comprehensive understanding of the relationship between meteor falls and celestial events. This may involve color-coding individual meteors to indicate the celestial event that triggered them or incorporating a map of the solar system to illustrate Earth's position relative to these events.

By embedding this contextual information into our visualizations, we aim to elucidate the dynamic interplay between Earth and its celestial surroundings, showcasing how meteor falls are intricately connected to the broader cycles of space. This approach not only enhances our understanding of meteor phenomena but also highlights Earth's role within the solar system.

## Conculsion

"Meteoric Fall: A Comet-ment to Data" embarked on a journey to unravel the mysteries of meteorite impacts by employing various data visualization techniques. Our project sought to explore the intricate relationships between Earth and space through dynamic visualizations, delving into questions surrounding meteorite distribution, historical events, and celestial phenomena. By leveraging interactive tools like leaflet maps, animated timelines, and density maps, we unearthed captivating insights into the geographic distribution of meteor impacts and their correlation with historical occurrences and known celestial events. From identifying continents with the highest meteorite accumulation to elucidating the interplay between Earth's proximity to astronomical phenomena, our analysis offers a nuanced understanding of meteorites. Through user-friendly visualizations, we aspire to ignite curiosity and foster deeper exploration in fields such as geology, astronomy, and data analytics, paving the way for future discoveries and scientific advancements.
