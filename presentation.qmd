---
title: "Meteoric Fall: a comet-ment to data"
subtitle: "INFO 526 - Spring 2024 - Project Final"
author: "**Viz Wizards** - Nick Ferrante, Jeremiah Gaiser, Tanya Evita George, Mrunal Jadhav, Jasdeep Singh Jhajj, Gillian McGinnis, Agastya Deshraju"
title-slide-attributes:
  data-background-image: images/meteor_bg1.png
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  [beige,data/customtheming.scss]
    transition: concave
    logo: images/meteor_logo.png
    footer: "[☄️ VizWizards](https://github.com/INFO-526-S24/project-final-VizWizards/)"
    background-transition: fade
  
editor: visual
execute:
  echo: false
---


```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3,
  dpi = 300,
  #fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here
#data(mtcars)
#mtcars$speed <- mtcars$hp / mtcars$wt

#data("penguins")
```

```{r load_pkgs}
#| label: load_pkgs
#| message: false
#| warning: false
#| code-summary: "Load Packages"

if (!require("pacman")) 
  install.packages("pacman")

pacman::p_load(tidyverse,
               readr,
               leaflet,
               here,
               gganimate,
               magick,
               sysfonts,
               showtext,
               DT,
               maps) 
```

```{r load_dataset}
#| label: load_dataset
#| message: false
#| warning: false
#| code-summary: "Load Dataset"
# Read the CSV file
meteorite_data <- read_csv(here("data/Meteorite_Landings.csv"))
```

```{r data_cleaning}
#| label: data_cleaning
#| message: false
#| warning: false
#| code-summary: "Data Cleaning"

meteorite_data <- meteorite_data |> 
  na.omit(year)

meteorite_data$year <- as.numeric(meteorite_data$year)

meteorite_data_filtered <- meteorite_data |>
                            filter(year > 860 & year < 2100)

meteorite_data_filtered$reclong[meteorite_data_filtered$reclat == 0 &
                                meteorite_data_filtered$reclong == 0] <- NA
meteorite_data_filtered$reclat[meteorite_data_filtered$reclat == 0 & 
                               meteorite_data_filtered$reclong == 0] <- NA


meteorite_data_filtered <- meteorite_data_filtered |>
  rename(mass = `mass (g)`)
```

## Understanding the Dataset {transition="convex-in zoom-out"}

::: {#smallerTxt}

-   Introduction points
-   The data set Meteorite_Landings.csv, has been sourced from NASA's Open Data Portal.
-   The dimensions include 10 variables i.e. 6 numerical and 4 categorical variables.

:::

# Question 1 {.smaller transition="zoom-in concave-out"}

What does the distribution of meteor impacts look like across the earth?
-   Which continents have accumulated the most total mass of meteors?

## Meteorites recorded before and after falling {.smaller transition="slide-in convex-out"}

::: panel-tabset

#### Plot A {.smaller}
```{r filter_meteorites, fig.asp = 0.430, fig.alt= "World map showing the different recorded locations where meteorites fell to Earth"}
#| label: filter_meteorites
#| message: false
#| warning: false
#| code-summary: "Filtering meteorites"
#| fig.height: 5
#| fig.width: 10

# Adding a filter to classify the size of the meteorites
filtered_data <- subset(meteorite_data_filtered, mass > 1000 & fall == "Fell")
filtered_data$meteor_size <- cut(filtered_data$mass,
                                 breaks = c(0, 10000, 100000, Inf),
                                 labels = c("light", "average mass", "heavy"))

# Plot the world map
world_map <- ggplot() +
  geom_polygon(data = map_data("world"),
               aes(x = long,
                   y = lat,
                   group = group),
               fill = "lightblue",
               color = "black",
               size = 0.25) +
  geom_point(data = filtered_data,
             aes(x = reclong,
                 y = reclat,
                 color = meteor_size),
             size = 0.7) +
  labs(title = "Meteorite Landings (Fallen)") +
  scale_color_manual(values = c("light" = "yellow",
                                "average mass" = "orange",
                                "heavy" = "red")) +
  theme_minimal() +
  labs(x = "Longitude",
       y = "Latitude",
       color = "Meteor Size") +
  theme(
    legend.position = "bottom"
  )

# Show the plot
print(world_map)

```


#### Plot B {.smaller}

```{r meteorite_found, fig.asp = 0.430, fig.alt= "World map showing the different recorded locations of meteorites before falling"}
#| label: meteorite_found
#| message: false
#| warning: false
#| code-summary: "Plotting Found meteorites"
#| fig.height: 5
#| fig.width: 10

# Filter the data for meteorites that have not fallen and classify mass
filtered_data_not_fallen <- subset(meteorite_data_filtered, mass > 1000 & fall == "Found")
filtered_data_not_fallen$meteor_size <- cut(filtered_data_not_fallen$mass,
                                            breaks = c(0, 10000, 100000, Inf), 
                                            labels = c("light", "average mass", "heavy"))

# Plot the world map for meteorites that have not fallen
world_map_not_fallen <- ggplot() +
  geom_polygon(data = map_data("world"),
               aes(x = long,
                   y = lat,
                   group = group),
               fill = "lightblue",
               color = "black",
               size = 0.25) +
  geom_point(data = filtered_data_not_fallen,
             aes(x = reclong,
                 y = reclat,
                 color = meteor_size),
             size = 0.7) +
  labs(title = "Meteorite Landings (Not Fallen)") +
  scale_color_manual(values = c("light" = "yellow",
                                "average mass" = "orange",
                                "heavy" = "red")) +
  theme_minimal() +
  labs(x = "Longitude",
       y = "Latitude",
       color = "Meteor Size") +
  theme(
    legend.position = "bottom"
  )

# Show the plot
print(world_map_not_fallen)


```
:::


## Insights {.smaller auto-animate="true"}
::: incremental
::: {#smallerTxt}

-   The top 2 locations of the heaviest meteors that fell were reported to be near the Kazakhstan border along Russia and in parts of USA.
-   Only the USA and a majority of Australia seem to have the maximum recorded visuals of meteors in the whole world.
-   It is also surprising to note that while a lot of meteors were sighted in the USA, there was almost a negligible count of sightings recorded in its neighboring country, Canada.
-   The country with the maximum number of sightings of fallen meteors is India and the continent with most sightings of meteors before falling is Europe.

:::
:::

## Leaflet Plot for Fallen Meteorites {.smaller transition="slide-in convex-out"}

::: panel-tabset

#### Plot C {.smaller}

```{r leaflet_plot, fig.asp = 0.160}
#| label: leaflet_plot
#| message: false
#| warning: false
#| code-summary: "Leaflet Plot for Fallen Meteorites"


# Filtered Meteorite data for Fallen, Not Found
meteorite_data_filtered_fell <- meteorite_data_filtered |>
  filter(meteorite_data_filtered$fall == "Fell")


map_plot <- leaflet(data = meteorite_data_filtered_fell) |>
  addTiles() |>
  addMarkers(lat = ~reclat, 
             lng = ~reclong,
             clusterOptions = markerClusterOptions(), 
             popup = ~paste("Name:", name,
                            "<br>Class:", recclass,
                            "<br>Mass:", mass, "g",
                            "<br>Year:", year,
                            "<br>Latitude:", reclat,
                            "<br>Longitude:", reclong),
             icon = makeIcon("images/meteorite.png", 
                             iconWidth = 20, 
                             iconHeight = 20))

map_plot
```

#### Insights from the Leaflet Plot

-   The continents that have accumulated the most total mass of meteors are Europe and North America.
- Something
:::


# Question 2 {.smaller transition="zoom-in concave-out"}

How do historical events relate to the observations and discoveries of meteors?

## Question 2 - Plots {.smaller transition="slide-in convex-out"}

::: panel-tabset

#### Plot A {.smaller}

#### Insights {.smaller auto-animate="true"}

:::

# Question 3 {.smaller transition="zoom-in concave-out"}

Are trends observed in frequency, type, or location of meteors, related to known celestial events?

## Question 3 - Plots {.smaller transition="slide-in convex-out"}

::: panel-tabset

#### Plot A {.smaller}

#### Insights {.smaller auto-animate="true"}

:::

# R Shiny application:
[Shiny App for Meteor Landings](https://gmcginnis.shinyapps.io/MeteoriteMap/)


# Using Quarto for presentations

## Quarto

-   The presentation is created using the Quarto CLI

-   `##` sets the start of a new slide

## Layouts

You can use plain text

::: columns
::: {.column width="40%"}
-   or bullet points[^1]
:::

::: {.column width="60%"}
or in two columns
:::
:::

[^1]: And add footnotes

-   like

-   this

## Code

```{r, echo=FALSE}
#model <- lm(mpg ~ speed, data = mtcars) 

#model |> tidy()

#model |> glance()

```

## Plots

```{r}
#penguins |>
 # mutate(species = ifelse(species == "Adelie", "Adelie", "Other")) |>
  #ggplot(aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  #geom_point()
```

## Plot and text

::: columns
::: {.column width="50%"}
-   Some text

-   goes here
:::

::: {.column width="50%"}
```{r, warning=FALSE, fig.width=5.5}
#penguins |>
 # ggplot(aes(x = bill_length_mm, y = species, color = species)) +
  #geom_boxplot(linewidth = 0.75,
   #            outlier.size = 2.5) +
  #theme_minimal(base_size = 15) +
  #theme(legend.key.size = unit(0.8, "cm"))
```
:::
:::

# A new section...

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r}
#penguins |> 
 # head() |>
  #kableExtra::kable() |>
  #kableExtra::kable_styling()
```

## Images

![Image credit: Danielle Navarro, Percolate.](images/watercolour_sys02_img34_teacup-ocean.png){fig-align="center" width="500"}

## Math Expressions {.smaller}

You can write LaTeX math expressions inside a pair of dollar signs, e.g. \$\\alpha+\\beta\$ renders $\alpha + \beta$. You can use the display style with double dollar signs:

```         
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$
\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
$$

Limitations:

1.  The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

2.  There should not be spaces after the opening `$` or before the closing `$`.

# Wrap up

## Feeling adventurous?

-   You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

-   But some of you might want to play around with slide styling. Some solutions for this can be found at https://quarto.org/docs/presentations/revealjs.
